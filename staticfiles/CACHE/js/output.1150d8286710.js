user_id=sessionStorage.getItem('user_id');$(document).ready(function(){var csrftoken=getCookie('csrftoken');console.log('User ID:',user_id);$.ajax({url:'api/formula/list/',method:'GET',data:{user_id:user_id},headers:{'X-CSRFToken':csrftoken},beforeSend:function(xhr,settings){console.log('Before sending request',settings.data);},success:function(data,textStatus,xhr){console.log('Received data:',data);console.log('Status:',textStatus);console.log('Response headers:',xhr.getAllResponseHeaders());var formulaList=$('<ul id="formulae-list">');data.forEach(function(formula){var formulaItem=$('<li>').addClass('formula-item');var nameLabel=$('<p id = "formula-name">').text('Name: '+formula.name);var timeEditedLabel=$('<p id = "formula-edit-time">').text('Edited: '+formula.updated_at);var viewButton=$('<button class= "btn btn-primary btn-formula" id = "view-formula">').text('View Formula');var editButton=$('<button class= "btn btn-primary btn-formula" id = "edit-formula">').text('Edit Formula');formulaItem.append(nameLabel,timeEditedLabel,viewButton,editButton);formulaList.append(formulaItem);});$('#sidebar').append(formulaList);},error:function(xhr,status,error){console.error('Error fetching data:',error);console.log('Status:',status);console.log('Response headers:',xhr.getAllResponseHeaders());}});});$(document).ready(function(){$('.formula-link').on('click',function(e){e.preventDefault();var formulaId=$(this).data('id');$.get('api/'+formulaId,function(data){$('#main-content').data('formulaData',data).html(data);});});});$('#create-button').on('click',function(){var formData={name:'',description:'',ingredients:[]};$.ajax({url:'/api/new/',type:'POST',data:JSON.stringify(formData),contentType:'application/json; charset=utf-8',dataType:'json',success:function(data){window.location.href='/edit-formula/'+data.id;}});});function getCookie(name){var cookieValue=null;if(document.cookie&&document.cookie!==''){var cookies=document.cookie.split(';');for(var i=0;i<cookies.length;i++){var cookie=$.trim(cookies[i]);if(cookie.substring(0,name.length+1)===(name+'=')){cookieValue=decodeURIComponent(cookie.substring(name.length+1));break;}}}
return cookieValue;};